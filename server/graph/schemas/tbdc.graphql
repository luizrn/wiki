# ===============================================
# TBDC PERMISSIONS SYSTEM
# ===============================================

type TBDCStaff {
  id: Int!
  name: String!
  email: String!
  role: String!
  createdAt: String!
  updatedAt: String!
}

type TBDCCompany {
  id: Int!
  name: String!
  focalName: String
  focalEmail: String
  focalPhone: String
  alihamento: String
  csId: Int
  implantadorId: Int
  cs: TBDCStaff
  implantador: TBDCStaff
  isActive: Boolean!
  permissions: [TBDCPermission]
  createdAt: String!
  updatedAt: String!
}

type TBDCProduct {
  id: Int!
  name: String!
  modules: [TBDCModule]
  createdAt: String!
  updatedAt: String!
}

type TBDCModule {
  id: Int!
  name: String!
  productId: Int!
  product: TBDCProduct
  createdAt: String!
  updatedAt: String!
}

type TBDCPermission {
  id: Int!
  companyId: Int!
  moduleId: Int!
  ruleName: String!
  level: String!
  description: String
  isActive: Boolean!
  module: TBDCModule
  createdAt: String!
  updatedAt: String!
}

type TBDCPermissionLevel {
  id: Int!
  code: String!
  label: String!
  description: String
  color: String!
  order: Int!
  isActive: Boolean!
  createdAt: String!
  updatedAt: String!
}

input TBDCPermissionInput {
  id: Int
  moduleId: Int!
  ruleName: String!
  level: String!
  description: String
  isActive: Boolean
}

input TBDCPermissionLevelInput {
  id: Int
  code: String!
  label: String!
  description: String
  color: String!
  order: Int
  isActive: Boolean
}

# -----------------------------------------------
# QUERIES
# -----------------------------------------------

extend type Query {
  tbdc: TBDCQuery
}

type TBDCQuery {
  companies: [TBDCCompany]
  company(id: Int!): TBDCCompany
  products: [TBDCProduct]
  staff: [TBDCStaff]
  permissionLevels: [TBDCPermissionLevel]
}

# -----------------------------------------------
# MUTATIONS
# -----------------------------------------------

extend type Mutation {
  tbdc: TBDCMutation
}

type TBDCMutation {
  saveCompany(
    id: Int
    name: String!
    focalName: String
    focalEmail: String
    focalPhone: String
    alihamento: String
    csId: Int
    implantadorId: Int
    isActive: Boolean
    permissions: [TBDCPermissionInput]
  ): TBDCCompany

  deleteCompany(id: Int!): Boolean

  saveProduct(id: Int, name: String!): TBDCProduct @auth(requires: ["manage:system"])
  deleteProduct(id: Int!): Boolean @auth(requires: ["manage:system"])

  saveModule(id: Int, productId: Int!, name: String!): TBDCModule @auth(requires: ["manage:system"])
  deleteModule(id: Int!): Boolean @auth(requires: ["manage:system"])

  saveStaff(id: Int, name: String!, email: String!, role: String!): TBDCStaff @auth(requires: ["manage:system"])
  deleteStaff(id: Int!): Boolean @auth(requires: ["manage:system"])

  savePermissionLevel(
    id: Int
    code: String!
    label: String!
    description: String
    color: String!
    order: Int
    isActive: Boolean
  ): TBDCPermissionLevel @auth(requires: ["manage:system"])
  deletePermissionLevel(id: Int!): Boolean @auth(requires: ["manage:system"])
}
